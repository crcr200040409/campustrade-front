{"version":3,"file":"home.js","sources":["pages/home/home.vue","../../../../../../ProgramFiles/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaG9tZS9ob21lLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <!-- Notice bar at the top -->\n    <uni-notice-bar show-icon scrollable text=\"5月1号-5月5号放假要调休\" />\n\n    <!-- Main content area -->\n    <view class=\"main-content\">\n      <uni-search-bar\n          @confirm=\"search\"\n          :focus=\"true\"\n          v-model=\"searchValue\"\n          @blur=\"blur\"\n          @focus=\"focus\"\n          @input=\"input\"\n          @cancel=\"cancel\"\n          @clear=\"clear\">\n      </uni-search-bar>\n\n      <!-- Section headers for navigation -->\n      <view class=\"section-headers\">\n        <text class=\"section-header\" @click=\"findLike()\">猜你喜欢</text>\n        <text class=\"section-header\" @click=\"findNewpush()\">最新发布</text>\n        <text class=\"section-header\" @click=\"changeTab(2)\">价格</text>\n        <text class=\"section-header filter\" @click=\"changeTab(3)\">筛选</text>\n      </view>\n\n      <view class=\"product-list\">\n        <view class=\"product-card\" v-for=\"(product, index) in productList\" :key=\"index\" @click=\"viewProductDetail(product.commodityId)\">\n          <image :src=\"product.commodityPhoto || '/images/default.jpg'\" mode=\"aspectFill\" class=\"product-image\" />\n          <text class=\"product-title\">{{ product.commodityName }}</text>\n          <text class=\"product-description\">{{ product.commodityDescription }}</text>\n          <text class=\"product-price\">¥{{ product.commodityPrice.toFixed(2) }}</text>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n\n\n<script setup>\nimport { ref, onMounted ,onUnmounted} from 'vue';\nimport request from \"@/api/request.js\"; // 导入封装的请求方法\n\n// 初始化数据\nconst searchValue = ref('');\nconst productList = ref([]);\n\n// 模拟从接口获取商品数据\nconst fetchProductList = async () => {\n  try {\n    const response = await request({\n      url: \"/commodity/listCommodity\", // 请求商品列表接口\n      method: \"POST\",\n      data: {\n        pageSize: 10,\n        pageIndex: 1\n      }\n    });\n    //console.log(\"response----------->\", JSON.stringify(response, 2));\n    if (response.code === 200 && response.data) {\n      productList.value = response.data; // 设置商品数据\n    } else {\n      uni.showToast({\n        title: '获取商品列表失败',\n        icon: 'none'\n      });\n    }\n  } catch (error) {\n    console.error(\"请求商品列表失败\", error);\n    uni.showToast({\n      title: '请求失败',\n      icon: 'none'\n    });\n  }\n};\n// 点击商品卡片查看详情\nconst viewProductDetail = async (commodityId) => {\n  uni.navigateTo({\n    url: `/pages/productDetail/productDetail?commodityId=${commodityId}` // 传递 commodityId 参数\n  });\n};\n// 搜索函数\nconst search = () => {\n  uni.showToast({\n    title: '正在搜索：' + searchValue.value,\n    icon: 'none'\n  });\n  uni.navigateTo({\n    url: `/pages/search/search?keyword=${searchValue.value}`,  // 传递关键词\n  });\n};\n\n// 输入事件\nconst input = (res) => {\n  searchValue.value = res.value;  // 实时更新搜索框的值\n};\n// 取消搜索\nconst cancel = () => {\n  searchValue.value = '';  // 清空搜索框\n};\n\n// 页面加载时获取商品列表\nonMounted(() => {\n  fetchProductList(); // 页面加载时调用一次获取商品列表的函数\n  // 每分钟调用一次获取商品列表函数\n  const intervalId = setInterval(() => {\n    fetchProductList();\n  }, 60000); // 60000 毫秒 = 1 分钟\n\n  // 页面卸载时清除定时器\n  onUnmounted(() => {\n    clearInterval(intervalId);\n  });\n});\n</script>\n\n<style scoped>\n.container {\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  background-color: #f5f5f5;\n}\n\n.main-content {\n  flex-grow: 1;\n  padding: 15px;\n}\n.section-headers {\n  display: flex;\n  margin-bottom: 15px;\n  border-bottom: 1px solid #eee;\n  padding-bottom: 10px;\n}\n\n.section-header {\n  margin-right: 20px;\n  font-size: 16px;\n  color: #666;\n}\n\n.section-header.active {\n  color: #1d9bf0;\n  font-weight: bold;\n}\n\n.section-header.filter {\n  margin-left: auto;\n  margin-right: 0;\n}\n\n.product-list {\n  background-color: white;\n  border-radius: 8px;\n  padding: 10px;\n}\n\n.product-card {\n  padding: 15px 0;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.product-card:last-child {\n  border-bottom: none;\n}\n\n.product-title {\n  font-size: 16px;\n  font-weight: bold;\n  display: block;\n  margin-bottom: 5px;\n}\n\n.product-description {\n  font-size: 14px;\n  color: #666;\n  display: block;\n  margin-bottom: 5px;\n}\n\n.product-price {\n  font-size: 16px;\n  color: #ff6b00;\n  display: block;\n}\n\n.product-image {\n  width: 100%;\n  height: 200px;\n  object-fit: cover;\n  margin-bottom: 10px;\n}\n</style>\n","import MiniProgramPage from 'D:/作业/软件工程/课程设计/campustrade/code/campustrade-front/pages/home/home.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","request","uni","onMounted","onUnmounted"],"mappings":";;;;;;;;;;;;;;;;AA6CA,UAAM,cAAcA,cAAAA,IAAI,EAAE;AAC1B,UAAM,cAAcA,cAAAA,IAAI,CAAA,CAAE;AAG1B,UAAM,mBAAmB,YAAY;AACnC,UAAI;AACF,cAAM,WAAW,MAAMC,oBAAQ;AAAA,UAC7B,KAAK;AAAA;AAAA,UACL,QAAQ;AAAA,UACR,MAAM;AAAA,YACJ,UAAU;AAAA,YACV,WAAW;AAAA,UACZ;AAAA,QACP,CAAK;AAED,YAAI,SAAS,SAAS,OAAO,SAAS,MAAM;AAC1C,sBAAY,QAAQ,SAAS;AAAA,QACnC,OAAW;AACLC,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,UACd,CAAO;AAAA,QACF;AAAA,MACF,SAAQ,OAAO;AACdA,sBAAA,MAAA,MAAA,SAAA,6BAAc,YAAY,KAAK;AAC/BA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACF;AAAA,IACH;AAEA,UAAM,oBAAoB,OAAO,gBAAgB;AAC/CA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,kDAAkD,WAAW;AAAA;AAAA,MACtE,CAAG;AAAA,IACH;AAEA,UAAM,SAAS,MAAM;AACnBA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO,UAAU,YAAY;AAAA,QAC7B,MAAM;AAAA,MACV,CAAG;AACDA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,gCAAgC,YAAY,KAAK;AAAA;AAAA,MAC1D,CAAG;AAAA,IACH;AAGA,UAAM,QAAQ,CAAC,QAAQ;AACrB,kBAAY,QAAQ,IAAI;AAAA,IAC1B;AAEA,UAAM,SAAS,MAAM;AACnB,kBAAY,QAAQ;AAAA,IACtB;AAGAC,kBAAAA,UAAU,MAAM;AACd;AAEA,YAAM,aAAa,YAAY,MAAM;AACnC;MACD,GAAE,GAAK;AAGRC,oBAAAA,YAAY,MAAM;AAChB,sBAAc,UAAU;AAAA,MAC5B,CAAG;AAAA,IACH,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjHD,GAAG,WAAW,eAAe;"}