{"version":3,"names":["logout","_ref","_asyncToGenerator2","_regeneratorRuntime2","mark","_callee","wrap","_callee$","_context","prev","next","common_vendor","index","removeStorageSync","showToast","title","icon","reLaunch","url","stop","apply","arguments","goMyPublish","navigateTo","userInfo","ref","getStorageSync","avatar","userName","phoneNumber","userGender","openId","showModal","chooseAvatar","chooseImage","count","success","res","tempFilePaths","value","openSettingModal","closeSettingModal","saveUserInfo","_ref2","_callee2","updatedUserInfo","_callee2$","_context2","_objectSpread2","__f__","JSON","stringify","api_request","request","method","data","sent","code","setStorageSync","t0","wx","createPage","MiniProgramPage"],"sources":["profile.vue","cGFnZXMvcHJvZmlsZS9wcm9maWxlLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <!-- 头像和设置部分 -->\n    <view class=\"header\">\n      <image :src=\"userInfo.avatar\" class=\"avatar\" />\n      <view class=\"user-info\">\n        <text class=\"user-id\">昵称：{{ userInfo.userName }}</text>\n      </view>\n      <button class=\"setting-btn\" @click=\"openSettingModal\">设置</button>\n    </view>\n\n    <!-- 我的交易部分 -->\n    <view class=\"section\">\n      <text class=\"section-title\">我的交易</text>\n      <button class=\"item-button\" @click=\"goMyPublish\">\n        <uni-icons type=\"plusempty\" size=\"20\" color=\"#000\" class=\"icon\"></uni-icons>\n        <text class=\"button-text\">我发布的</text>\n      </button>\n\n      <button class=\"item-button\">\n        <uni-icons type=\"cart-filled\" size=\"20\" color=\"#000\" class=\"icon\"></uni-icons>\n        <text class=\"button-text\">我卖出的</text>\n      </button>\n    </view>\n\n    <!-- 常用工具部分 -->\n    <view class=\"section\">\n      <text class=\"section-title\">常用工具</text>\n      <button class=\"item-button\" @click=\"goMyCollect()\">\n        <uni-icons type=\"star-filled\" size=\"20\" color=\"#000\" class=\"icon\"></uni-icons>\n        <text class=\"button-text\">我的收藏</text>\n      </button>\n      <button class=\"item-button\" @click=\"contactService()\">\n        <uni-icons type=\"phone\" size=\"20\" color=\"#000\" class=\"icon\"></uni-icons>\n        <text class=\"button-text\">联系客服</text>\n      </button>\n      <button class=\"item-button\">\n        <uni-icons type=\"mail-open\" size=\"20\" color=\"#000\" class=\"icon\"></uni-icons>\n        <text class=\"button-text\">意见反馈</text>\n      </button>\n      <button class=\"item-button\">\n        <uni-icons type=\"help\" size=\"20\" color=\"#000\" class=\"icon\"></uni-icons>\n        <text class=\"button-text\">关于吉刻转</text>\n      </button>\n      <button class=\"item-button\" @click=\"logout\">\n        <uni-icons type=\"back\" size=\"20\" color=\"#000\" class=\"icon\"></uni-icons>\n        <text class=\"button-text\">退出</text>\n      </button>\n    </view>\n\n    <!-- 用户信息设置弹窗 -->\n    <view v-if=\"showModal\" class=\"modal-overlay\" @click=\"closeSettingModal\">\n      <view class=\"modal-content\" @click.stop>\n        <text class=\"modal-title\">编辑个人信息</text>\n        <input v-model=\"userInfo.userName\" placeholder=\"修改昵称\" class=\"modal-input\" />\n        <input v-model=\"userInfo.phoneNumber\" placeholder=\"修改手机号\" class=\"modal-input\" type=\"tel\" />\n        <button class=\"upload-avatar-btn\" @click=\"chooseAvatar\">上传头像</button>\n        <view class=\"gender-select\">\n          <radio-group @change=\"(e) => userInfo.userGender = e.detail.value\" class=\"gender-group\">\n            <label class=\"gender-option\">\n              <radio value=\"1\" :checked=\"userInfo.userGender === 1\" />\n              <text>男</text>\n            </label>\n            <label class=\"gender-option\">\n              <radio value=\"0\" :checked=\"userInfo.userGender === 0\" />\n              <text>女</text>\n            </label>\n          </radio-group>\n        </view>\n\n\n        <view class=\"button-group\">\n          <button class=\"save-btn\" @click=\"saveUserInfo\">保存</button>\n          <button class=\"cancel-btn\" @click=\"closeSettingModal\">取消</button>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref } from 'vue';\nimport request from '@/api/request.js';  // 引入请求函数\nconst logout = async () => {\n  uni.removeStorageSync('userInfo');\n  // 显示退出成功的提示\n  uni.showToast({\n    title: '退出成功',\n    icon: 'success'\n  });\n  // 跳转到登录页面\n  uni.reLaunch({\n    url: '/pages/index/index' // 登录页面路径根据实际项目调整\n  });\n}\nconst goMyPublish = () => {\n  uni.navigateTo({\n    url: '/pages/publish/publish'  // 请确保路径与你项目中实际页面路径一致\n  });\n}\n// 获取缓存中的用户信息\nconst userInfo = ref(uni.getStorageSync('userInfo') || {\n  avatar: \"/static/logo.png\",\n  userName: \"微信用户\",\n  phoneNumber: null,\n  userGender: 0,\n  openId: \"u001\"\n});\n\nconst showModal = ref(false);  // 控制弹窗显示\nconst chooseAvatar = () => {\n  uni.chooseImage({\n    count: 1,  // 只选择一个图片\n    success: (res) => {\n      // 获取用户选择的头像\n      const avatar = res.tempFilePaths[0];\n      userInfo.value.avatar = avatar; // 更新头像\n    }\n  });\n};\n// 打开设置弹窗\nconst openSettingModal = () => {\n  showModal.value = true;\n};\n// 关闭设置弹窗\nconst closeSettingModal = () => {\n  showModal.value = false;\n};\n\n// 保存用户信息\nconst saveUserInfo = async () => {\n  const updatedUserInfo = { ...userInfo.value };\n  // 调用接口更新用户信息\n  try {\n    console.log(\"updatedUserInfo----------->\", JSON.stringify(updatedUserInfo, null, 2));\n\n    const res = await request({\n      url: \"/user/updateProfile\",\n      method: \"POST\",\n      data: updatedUserInfo\n    });\n\n    if (res.code === 200) {\n      // 保存更新后的用户信息到缓存\n      uni.setStorageSync('userInfo', updatedUserInfo);\n      uni.showToast({\n        title: '更新成功！',\n        icon: 'success'\n      });\n      closeSettingModal();\n    } else {\n      uni.showToast({\n        title: '更新失败',\n        icon: 'none'\n      });\n    }\n  } catch (error) {\n    console.error('更新用户信息失败', error);\n    uni.showToast({\n      title: '更新失败',\n      icon: 'none'\n    });\n  }\n};\n</script>\n\n<style scoped>\n.container {\n  padding: 20px;\n  background-color: #f8f8f8;\n}\n.gender-select {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.gender-group {\n  display: flex;\n  flex-direction: row;  /* 确保水平排列 */\n  gap: 20px;  /* 设置两个选项之间的间距 */\n}\n\n.gender-option {\n  display: flex;\n  align-items: center;\n  gap: 5px;\n}\n.header {\n  display: flex;\n  align-items: center;\n  background-color: #2196F3; /* 蓝色背景 */\n  padding: 15px;\n  border-radius: 8px;\n  margin-bottom: 20px;\n  color: white; /* 白色字体 */\n}\n\n.avatar {\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  margin-right: 10px;\n}\n\n.user-info {\n  flex-grow: 1;\n}\n\n.user-id {\n  font-size: 14px;\n}\n\n.setting-btn {\n  background-color: #fff;\n  color: #2196F3;\n  padding: 8px 16px;\n  border-radius: 6px;\n  font-size: 14px;\n  border: none;\n}\n\n.section {\n  background-color: white;\n  padding: 15px;\n  margin-bottom: 20px;\n  border-radius: 8px;\n}\n.gender-select {\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n}\n\n.item-button {\n  display: flex;\n  align-items: center;\n  background-color: white;\n  color: #000;\n  padding: 1px 17px;\n  margin-top: 10px;\n  border-radius: 6px;\n  text-align: left;\n  font-size: 8px;\n  width: 100%;\n  border: 1px solid #ddd;\n}\n\n.icon {\n  margin-right: 10px; /* 设置图标和文字之间的间距 */\n}\n\n.button-text {\n  font-size: 16px;\n  color: #000; /* 设置文字颜色为黑色 */\n}\n\n/* 弹窗样式 */\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.modal-content {\n  background-color: white;\n  padding: 20px;\n  border-radius: 8px;\n  width: 80%;\n  max-width: 400px;\n}\n\n.modal-title {\n  font-size: 18px;\n  font-weight: bold;\n  margin-bottom: 20px;\n}\n\n.modal-input {\n  width: 100%;\n  padding: 10px;\n  margin-bottom: 15px;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n  font-size: 14px;\n}\n\n.upload-avatar-btn {\n  width: 100%;\n  padding: 10px;\n  margin-bottom: 15px;\n  background-color: #2196F3;\n  color: white;\n  border-radius: 6px;\n  font-size: 16px;\n  border: none;\n}\n\n\n.gender-selection button {\n  width: 48%;\n  padding: 10px;\n  background-color: #f0f0f0;\n  border-radius: 6px;\n  font-size: 16px;\n  border: 1px solid #ccc;\n}\n\n.gender-selection button.selected {\n  background-color: #2196F3;\n  color: white;\n}\n\n.button-group {\n  display: flex;\n  justify-content: space-between;\n}\n\n.save-btn, .cancel-btn {\n  width: 48%;\n  padding: 10px;\n  border-radius: 6px;\n  font-size: 16px;\n  border: none;\n}\n\n.save-btn {\n  background-color: #2196F3;\n  color: white;\n}\n\n.cancel-btn {\n  background-color: #ccc;\n  color: white;\n}\n\n\n</style>\n\n","import MiniProgramPage from 'D:/作业/软件工程/课程设计/campustrade/code/campustrade-front/pages/profile/profile.vue'\nwx.createPage(MiniProgramPage)"],"mappings":"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","ignoreList":[]}